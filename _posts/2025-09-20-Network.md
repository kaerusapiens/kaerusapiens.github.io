---
title: AWS,GPC로 배우는 네트워크의 기초
categories: [AWS, GCP, Network]
mermaid: true
---
# Network

## 브라우저에 접속하는 과정

```mermaid
sequenceDiagram
    participant User as 사용자<br/>클라이언트 컴퓨터<br/>10.0.0.10
    participant Browser as 웹 브라우저<br/>프로그램
    participant DNS as DNS 서버
    participant Internet as 인터넷
    participant Server as 서버 컴퓨터<br/>203.0.113.10
    participant WebServer as 웹 서버<br/>프로그램
    
    Note over User, WebServer: HTTP 요청 과정
    
    User->>Browser: http://example.com 입력
    Browser->>DNS: 도메인 이름 해석 요청
    DNS-->>Browser: example.com -> 203.0.113.10
    
    Browser->>Internet: HTTP 요청 패킷 전송
    Note over Browser, Internet: GET / HTTP/1.1
    
    Internet->>Server: 패킷 라우팅
    Server->>WebServer: HTTP 요청 처리
    WebServer-->>Server: HTTP 응답 생성
    Server-->>Internet: 응답 패킷 전송
    Internet-->>Browser: 패킷 수신
    Browser-->>User: 웹 페이지 표시
```
## 용어정리

| 용어 | 설명 |
|---|---|
| IP 주소 | 네트워크 상에서 장치를 식별하는 고유한 숫자자 주소 |
| IPv4 | 32비트 주소 체계로, 약 42억 개의 고유 주소 제공  <br> 예, '192.168.0.1' |
| IPv6 | 128비트 주소 체계로, 거의 무한대에 가까운 주소 제공 <br> 예, '2001:0db8:85a3:0000:0000:8a2e:0370:7334' |
| 도메인 이름 | 사람이 읽을 수 있는 형태의 웹사이트 주소 (예: example.com) |
| DNS (Domain Name System) | 도메인 이름을 IP 주소로 변환하는 시스템 |
| HTTP (Hypertext Transfer Protocol) | 웹 브라우저와 웹 서버 간의 통신 프로토콜 |
| HTTPS (HTTP Secure) | HTTP에 보안 기능을 추가한 프로토콜 (SSL/TLS 사용) |
| 웹 브라우저 | 사용자가 웹 페이지를 요청하고 표시하는 프로그램 (예: Chrome, Firefox) |
| NIC (Network Interface Card) | 컴퓨터를 네트워크에 연결하는 하드웨어 장치 |
| Packet | 네트워크를 통해 전송되는 데이터의 작은 단위 |

## TCPI/IP 4계층 모델
```mermaid
flowchart TD
    A[애플리케이션 계층<br/>Application Layer]
    B[전송 계층<br/>Transport Layer]
    C[인터넷 계층<br/>Internet Layer]
    D[네트워크 인터페이스 계층<br/>Network Interface Layer]
    
    A --> B
    B --> C
    C --> D
    
    A1[HTTP, FTP, SMTP<br/>사용자와 직접 상호작용<br/>메시지 형식과 통신 순서 정리]
    B1[TCP, UDP<br/>신뢰성 있는 데이터 전송 TCP<br/>비신뢰성 데이터 전송 UDP<br/>접속 확립, 패킷 분할/재조립]
    C1[IP, ICMP<br/>IP로 지정된 주소로<br/>패킷을 전송하는 역할]
    D1[Ethernet, Wi-Fi<br/>하드웨어가 통신을 실현]
    
    A --- A1
    B --- B1
    C --- C1
    D --- D1
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
```

[참고] 예를들어, Packet가 안도착 한다면 인터넷 계층에 문제를 생각할 수있음
통신은 되고 있으나 메시지가 이상하다면 어플리케이션 층에 문제를 생각할 수 있음 


## OSI 7계층 모델
```mermaid
flowchart TD
    A[애플리케이션 계층<br/>Application Layer]
    B[표현 계층<br/>Presentation Layer]
    C[세션 계층<br/>Session Layer]
    D[전송 계층<br/>Transport Layer]
    E[네트워크 계층<br/>Network Layer]
    F[데이터 링크 계층<br/>Data Link Layer]
    G[물리 계층<br/>Physical Layer]
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G
    
    A1[HTTP, FTP, SMTP<br/>사용자와 직접 상호작용]
    B1[암호화, 압축<br/>데이터 형식과 인코딩 관리]
    C1[세션 설정, 관리, 종료<br/>통신 세션 제어]
    D1[TCP, UDP<br/>신뢰성/비신뢰성 데이터 전송]
    E1[IP 주소<br/>패킷 라우팅]
    F1[MAC 주소<br/>인접 장치 간 데이터 전송]
    G1[전기적 신호<br/>물리적 데이터 전송]
    
    A --- A1
    B --- B1
    C --- C1
    D --- D1
    E --- E1
    F --- F1
    G --- G1
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
    style F fill:#f1f8e9
    style G fill:#fff8e1
```   


## 웹 서버 접속
- curl : HTTP 요청 테스트 (`curl -v http://localhost`)
- telnet : 원격 서버 접속 (`telnet localhost 80`)

1. 클라이언트에서 보내는 request 메시지
```bash
GET / HTTP/1.1
Host: localhost
User-Agent: curl/8.12.1
Accept: */*
```

2. 웹서버에서 보내는 response 메시지

```bash
HTTP/1.1 200 OK
Server: nginx/1.26.3 (Ubuntu)
Date: Sat, 20 Sep 2025 13:04:40 GMT
Content-Type: text/html

<!DOCTYPE html>
<html>
..
</html>
```

## 프로토콜 레벨

### UDP,TCP와의 차이점, 실시간 통신에서의 활용

- TCP: 연결 지향적, 신뢰성 있는 데이터 전송, 순서 보장, 오류 검출 및 수정
- UDP: 비연결 지향적, 빠른 전송 속도, 순서 보장 없음, 오류 검출 없음
- 실시간 통신(예: VoIP, 온라인 게임)에서는 지연 시간이 중요하므로 UDP가 선호됨

### HTTP/HTTPS

- HTTP(HyperText Transfer Protocol): 웹에서 브라우저(클라이언트)와 서버 간 데이터를 주고받는 애플리케이션 계층 프로토콜.
- 주로 **요청(Request)**과 응답(Response) 형태로 작동.
- HTTP: 비연결 지향적, 상태 비저장, 텍스트 기반
- HTTPS: HTTP에 보안 기능을 추가한 프로토콜 (SSL/TLS 사용)

#### HTTP 버전별 채택 현황
- HTTP/1.1: 여전히 많은 서버와 CDN에서 기본 지원.
- HTTP/2: 주요 브라우저·서버(Chrome, Firefox, Apache, Nginx)에서 널리 사용.
- HTTP/3: 초기 단계였지만, Google, Cloudflare, Meta 등 대형 플랫폼에서 빠르게 채택 중. 모바일 환경과 스트리밍 서비스에서 사용 확대.



| 구분           | HTTP/1.1                             | HTTP/2                            | HTTP/3                      |
| ------------ | ------------------------------------ | --------------------------------- | --------------------------- |
| **도입 시기**    | 1997                                 | 2015                              | 2022 (IETF 표준화)             |
| **기반 프로토콜**  | TCP                                  | TCP                               | **QUIC** (UDP 기반)           |
| **요청 처리 방식** | 요청당 하나의 연결, 순차적 처리(Pipelining 문제 존재) | **멀티플렉싱**: 단일 연결에서 여러 요청/응답 동시 처리 | 멀티플렉싱 + **빠른 연결 설정(0-RTT)** |
| **헤더 처리**    | 헤더 중복 많음, 압축 없음                      | **HPACK** 압축으로 헤더 크기 감소           | **QPACK** 압축                |
| **추가 기능**    | Keep-Alive                           | **서버 푸시(Server Push)**, 우선순위 제어   | QUIC 기반 혼잡 제어, 연결 이동성 지원    |
| **성능/지연**    | 지연(latency) 큼, HOL Blocking 발생       | HOL Blocking 감소, 성능 향상            | 네트워크 지연 최소화, 모바일 환경 최적화     |



### WebSocket

- WebSocket: 클라이언트와 서버 간의 양방향 통신을 가능하게 하는 프로토콜
- HTTP와의 차이점: 초기 핸드셰이크 후 지속적인 연결 유지
- 활용 예시: 실시간 채팅 애플리케이션, 실시간 알림 시스템
- WebSocket 통신 과정
    1. 클라이언트가 HTTP 요청을 통해 WebSocket 연결 요청
    2. 서버가 WebSocket 프로토콜로 업그레이드 응답
    3. 양방향 통신 시작



## Cloud Networking

### 용어정리

| 용어 | 설명 |
|---|---|
| VPC (Virtual Private Cloud) | 클라우드 내에서 격리된 가상 네트워크 환경 |
| 서브넷 (Subnet) | VPC 내에서 IP 주소 범위를 나눈 작은 네트워크 |
| CIDR (Classless Inter-Domain Routing) | IP 주소를 효율적으로 할당하고 관리하는 방법 |
| 라우팅 테이블 | 네트워크 트래픽의 경로를 정의하는 규칙 집합 |
| IGW (Internet Gateway) | VPC와 인터넷 간의 통신을 가능하게 하는 게이트웨이 |
| NAT GW (NAT Gateway) | 프라이빗 서브넷의 인스턴스가 인터넷에 접근할 수 있도록 하는 서비스 |

### VPC

#### Region
https://cloud.google.com/compute/docs/regions-zones#available
- 지리적으로 분리된 위치
- 각 리전은 여러 개의 가용 영역(Availability Zone, AZ)으로 구성
- 각 AZ는 독립적인 전원, 냉각 및 물리적 보안을 갖춘 데이터 센터 그룹(재해, 장애 방지목적)
- VPC는 네트워크 그 자체의 설계도예요. 이 설계도 안에서 서브넷, 라우팅 테이블, 방화벽 규칙 등을 정의하게 됩니다.

#### Subnet
- VPC 내에서 IP 주소 범위를 나눈 작은 네트워크. 이 서브넷 안에 Compute Engine 같은 인스턴스들을 배포하게 됩니다.

- 퍼블릭 서브넷: 인터넷과 직접 통신 가능 (IGW 연결)
- 프라이빗 서브넷: 인터넷과 직접 통신 불가 (NAT GW 통해 간접 통신 가능)



| 특징 | AWS VPC | GCP VPC |
|---|---|---|
| **범위** | **리전(Region)**에 종속된 **지역 리소스**입니다. | **전역(Global)**에 걸쳐 있는 **전역 리소스**입니다. |
| **생성 시점** | VPC를 만들 때 특정 리전을 지정해야 합니다. | VPC는 리전을 지정하지 않고 생성하며, 그 안에 여러 리전의 서브넷을 추가합니다. |
| **서브넷 위치** | VPC 내에서 특정 **가용 영역(Availability Zone)**에 속해야 합니다. | VPC 내에서 특정 **리전(Region)**에 속하며, 해당 리전의 모든 AZ에 걸쳐 배포 가능합니다. |
| **리전 간 통신** | 동일 리전 내 VPC 간: **VPC 피어링**<br>다른 리전 VPC 간: **VPC 피어링** 또는 **Transit Gateway** | 동일 VPC 내의 다른 리전 서브넷 간: **기본적으로 내부 IP를 통해 가능** (별도 설정 불필요) |
| **주요 철학** | **"리전 단위의 완벽한 격리"** | **"전역 네트워크의 단순성"** |

한 마디로 정리하면, AWS는 **"하나의 VPC는 하나의 리전에만 존재"**하고, GCP는 **"하나의 VPC가 여러 리전에 걸쳐 존재"**할 수 있습니다. 이 차이점 때문에 두 클라우드에서 멀티 리전(multi-region) 아키텍처를 설계하는 방식이 완전히 달라집니다.




#### Security Group & NACL

- **Security Group**: 인스턴스 수준에서 트래픽을 제어하는 가상 방화벽입니다. 인바운드 및 아웃바운드 규칙을 설정하여 특정 IP 주소나 포트에 대한 접근을 허용하거나 차단할 수 있습니다.
- **NACL (Network Access Control List)**: 서브넷 수준에서 트래픽을 제어하는 방화벽입니다. 인바운드 및 아웃바운드 규칙을 설정하여 서브넷에 대한 접근을 허용하거나 차단할 수 있습니다. NACL은 상태 비저장(stateless) 방식으로 작동합니다.


### IP address
- 0 ~ 255 (총 256개)로 구성하여 10진수로 표기
- IP 어드레스는, 네트워크부 와 호스트부로 나눌 수 있습니다.
    - 10.0.0.10 에서 예를들어 10.0.0 은 네트워크부, 10은 호스트부일 수 있습니다.
    - 같은 네트워크에 속하는 컴퓨터들에 대하여, 네트워크부는 같이하며 호스트부는 다르게 하여 주소를 부여하는 것이 가능.
    - **서브넷 마스크**란 어디까지가 네트워크부이고 어디부터가 호스트부인지를 나타내는 값입니다.
- IP 어드레스를 설정할 때는, 10.0.0.10과 같은 값과 같이, 추가로 서브넷 마스크(Subnet Mask)도 설정해야 합니다.
- 실제로 Windows, Mac에서도 수동으로 IP 어드레스를 설정할 때, 서브넷 마스크도 같이 설정합니다.

### 서브넷 마스크
- 서브넷 마스크는, IP 어드레스의 네트워크부와 호스트부를 구분하는 역할을 합니다.
- 서브넷 마스크는, IP 어드레스와 같은 4개의 옥텟으로 구성되며, 각 옥텟은 0~255의 값을 가집니다.
- **CIDR(Classless Inter-Domain Routing)** 표기법
    - 서브넷 마스크를 간단하게 표현하는 방법
    - 예를들어, 255.255.255.0 은 /24로 표현할 수 있습니다.
    - /8, /16, /24, /32 등이 자주 사용됩니다.

예시 표

| IP 어드레스 | 서브넷 마스크 | CIDR 표기법 | 네트워크부 | 호스트부 |
|---|---|---|---|---|
| 10.0.0.10 | 255.255.255.255 | /32 | | 10.0.0.10 |
| 10.0.0.10 | 255.255.240.0 | /20 | 10.0.0 | 0.10 |
| 10.0.0.10 | 255.255.255.0 | /24 | 10.0.0 | 10 |
| 10.0.1.10 | 255.255.0.0 | /16 | 10.0 | 1.10 |
| 10.0.2.10 | 255.0.0.0 | /8 | 10 | 0.2.10 |

- 예를들어 10.0.0.0/16 이라는 네트워크로 부터 서브넷을 작성하는 경우,
예를들어 서브넷은 10.0.0.0/24, 10.0.1.0/24, 10.0.2.0/24로 나눌 수 있습니다.

- `ip a` 명령어로 IP 어드레스와 서브넷 마스크를 확인할 수 있습니다.


--------

2. 네트워크 인프라 & 라우팅
"데이터가 어떻게 목적지를 찾아가는가"
- IPv4, 루팅, NAT
- 방화벽, Bot Management

3. 서비스 레이어 & 최적화
"사용자가 어떻게 서비스에 접근하고 최적화되는가"
- DNS, CDN, VPN
- 글로벌 로드 밸런싱
- 아카마이가 CDN임


4. 클라우드 네트워킹 & 운영
"실제 환경에서 어떻게 구현하고 관리하는가"
- AWS VPC, 서브넷, 라우팅 테이블, IGW, NAT GW



## 네트워크 인프라

- 로드 밸런서: L4/L7 차이점, 알고리즘 종류
- 프록시 서버: Forward/Reverse 프록시
- GSLB (Global Server Load Balancing): 지역별 트래픽 분산
- BGP (Border Gateway Protocol): 인터넷 라우팅의 핵심
